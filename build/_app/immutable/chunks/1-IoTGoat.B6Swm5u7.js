import{s as jt,n as Ne}from"./scheduler.Ce_0Mfso.js";import{S as $t,i as Dt,e as l,s as o,H as i,a as n,g as r,c as p,j as u,k as c,d as t,b as f,f as a}from"./index.-GHY6Bw3.js";function Ot(It){let h,Qe="About IoTGoat",X,d,Ue='Taken directly from OWASP’s IoTGoat <a href="https://github.com/OWASP/IoTGoat" rel="nofollow">github repository</a>, “IoTGoat is a deliberately insecure firmware created to educate software developers and security professionals with testing commonly found vulnerabilities in IoT devices.”',B,k,Je="For the purpose of the walkthrough, I assume you are on some linux machine but it’s probably possible to follow along on Windows & MacOS.",Y,m,Ke="Walkthrough & Steps",Z,v,Ve="Step 0: Download the Image",ee,w,Xe='I have downloaded the IoTGoat-raspberry-pi2.img file from the <a href="https://github.com/OWASP/IoTGoat/releases/tag/v1.0" rel="nofollow">v1.0 release</a> found on their github. We will use this firmware image as the basis of the walkthrough moving forward.',te,b,Be="Step 1: Understanding the Image",se,x,Ye=`Alright, so we have the image, now what? Well, we need to see if the image has anything useful. We can start by running binwalk. If you’ve never used it before, most package managers will have it available or you can visit their <a href="https://github.com/ReFirmLabs/binwalk/tree/binwalkv3" rel="nofollow">github.</a>
We’ll start by using binwalk to see what the file contains:`,ae,_,le,Ht='<code class="language-bash">binwalk IoTGoat-raspberry-pi2.img</code>',ne,C,Ze='The output will be fairly long so I will trim large sections to only contain the important information, you can find the full output <a href="https://github.com/morganconnors/IoTGoat-Walkthrough/blob/main/Walkthrough-Files/Step-1-binwalk" rel="nofollow">here.</a>',oe,g,pe,Et=`<code class="language-text">DECIMAL       HEXADECIMAL     DESCRIPTION
--------------------------------------------------------------------------------
29360128      0x1C00000       Squashfs filesystem, little endian, version 4.0, compression:xz, size: 3946402 bytes, 1333 inodes, blocksize: 262144 bytes, created: 2019-01-30 12:21:02</code>`,re,y,et="There’s a bunch of junk info in this output, but at the very end of this file e see a Squashfs filesystem. This is useful, so we’ll want to get extract this part of the image.",ie,T,tt="Step 2: Getting some data",ue,P,st="Since I don’t really want the rest of the system right now I will use <code>dd</code> to only get this section.",ce,I,fe,Mt='<code class="language-bash"><span class="token function">dd</span> <span class="token assign-left variable">if</span><span class="token operator">=</span>IoTGoat-raspberry-pi2.img <span class="token assign-left variable">bs</span><span class="token operator">=</span><span class="token number">1</span> <span class="token assign-left variable">skip</span><span class="token operator">=</span><span class="token number">29360128</span> <span class="token assign-left variable">of</span><span class="token operator">=</span>SquashFS.bin</code>',he,H,at="If I did want the contents of the entire system, I could run:",de,E,ke,Lt='<code class="language-bash">binwalk <span class="token parameter variable">-e</span> Contents/firmware-dump.bin</code>',me,M,lt="Next, we will need to make this .bin file useful.",ve,L,we,St='<code class="language-bash"><span class="token function">sudo</span> unsquashfs SquashFS.bin</code>',be,S,nt="Output:",xe,q,_e,qt=`<code class="language-bash">Parallel unsquashfs: Using <span class="token number">4</span> processors
<span class="token number">1225</span> inodes <span class="token punctuation">(</span><span class="token number">1008</span> blocks<span class="token punctuation">)</span> to <span class="token function">write</span>

<span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span>/<span class="token punctuation">]</span> <span class="token number">2233</span>/2233 <span class="token number">100</span>%

created <span class="token number">1011</span> files
created <span class="token number">108</span> directories
created <span class="token number">213</span> symlinks
created <span class="token number">1</span> device
created <span class="token number">0</span> fifos
created <span class="token number">0</span> sockets
created <span class="token number">0</span> hardlinkso unsquashfs SquashFS.bin</code>`,Ce,G,ot="Step 3: Figuring out what we have",ge,W,pt="Now we have a bunch of data, so what? Well, for challenge #1 we should look for passwords we can use. The first place I’m going to look is <code>etc/passwd</code> to see which users get access to a shell and <code>etc/shadow</code> to see the hashes of the users.",ye,R,rt="etc/passwd",Te,z,Pe,Gt=`<code class="language-text">root:x:0:0:root:/root:/bin/ash
daemon:*:1:1:daemon:/var:/bin/false
ftp:*:55:55:ftp:/home/ftp:/bin/false
network:*:101:101:network:/var:/bin/false
nobody:*:65534:65534:nobody:/var:/bin/false
dnsmasq:x:453:453:dnsmasq:/var/run/dnsmasq:/bin/false
iotgoatuser:x:1000:1000::/root:/bin/ash</code>`,Ie,F,it="etc/shadow",He,A,Ee,Wt=`<code class="language-text">root:$1$Jl7H1VOG$Wgw2F/C.nLNTC.4pwDa4H1:18145:0:99999:7:::
daemon:*:0:0:99999:7:::
ftp:*:0:0:99999:7:::
network:*:0:0:99999:7:::
nobody:*:0:0:99999:7:::
dnsmasq:x:0:0:99999:7:::
dnsmasq:x:0:0:99999:7:::
iotgoatuser:$1$79bz0K8z$Ii6Q/if83F1QodGmkb4Ah.:18145:0:99999:7:::</code>`,Me,j,ut='Looking at these files, <code>root</code> and <code>iotgoatuser</code> both get a shell and use MD5 (we can tell MD5 based on the <code>$1$</code> after the first colon - more info <a href="https://www.cyberciti.biz/faq/understanding-etcshadow-file/" rel="nofollow">here</a>).',Le,$,ct="It’s possible to crack the hashes of these users, so let’s set up hashcat.",Se,D,ft="For the user <code>root</code>, we will execute:",qe,O,Ge,Rt='<code class="language-undefined">hashcat -a 0 -m 500 root-hash.txt root-list.txt</code>',We,N,ht="Password",Re,Q,ze,zt='<code class="language-undefined">iotgoathardcodedpassword</code>',Fe,U,dt="For the user <code>iotgoatuser</code>, we will execute:",Ae,J,je,Ft='<code class="language-undefined">hashcat -a 0 -m 500 iotgoatuser-hash.txt iotgoatuser-list.txt</code>',$e,K,kt="Password",De,V,Oe,At='<code class="language-undefined">7ujMko0vizxv</code>';return{c(){h=l("h1"),h.textContent=Qe,X=o(),d=l("p"),d.innerHTML=Ue,B=o(),k=l("p"),k.textContent=Je,Y=o(),m=l("h1"),m.textContent=Ke,Z=o(),v=l("h2"),v.textContent=Ve,ee=o(),w=l("p"),w.innerHTML=Xe,te=o(),b=l("h2"),b.textContent=Be,se=o(),x=l("p"),x.innerHTML=Ye,ae=o(),_=l("pre"),le=new i(!1),ne=o(),C=l("p"),C.innerHTML=Ze,oe=o(),g=l("pre"),pe=new i(!1),re=o(),y=l("p"),y.textContent=et,ie=o(),T=l("h2"),T.textContent=tt,ue=o(),P=l("p"),P.innerHTML=st,ce=o(),I=l("pre"),fe=new i(!1),he=o(),H=l("p"),H.textContent=at,de=o(),E=l("pre"),ke=new i(!1),me=o(),M=l("p"),M.textContent=lt,ve=o(),L=l("pre"),we=new i(!1),be=o(),S=l("p"),S.textContent=nt,xe=o(),q=l("pre"),_e=new i(!1),Ce=o(),G=l("h2"),G.textContent=ot,ge=o(),W=l("p"),W.innerHTML=pt,ye=o(),R=l("p"),R.textContent=rt,Te=o(),z=l("pre"),Pe=new i(!1),Ie=o(),F=l("p"),F.textContent=it,He=o(),A=l("pre"),Ee=new i(!1),Me=o(),j=l("p"),j.innerHTML=ut,Le=o(),$=l("p"),$.textContent=ct,Se=o(),D=l("p"),D.innerHTML=ft,qe=o(),O=l("pre"),Ge=new i(!1),We=o(),N=l("p"),N.textContent=ht,Re=o(),Q=l("pre"),ze=new i(!1),Fe=o(),U=l("p"),U.innerHTML=dt,Ae=o(),J=l("pre"),je=new i(!1),$e=o(),K=l("p"),K.textContent=kt,De=o(),V=l("pre"),Oe=new i(!1),this.h()},l(e){h=n(e,"H1",{"data-svelte-h":!0}),r(h)!=="svelte-d54554"&&(h.textContent=Qe),X=p(e),d=n(e,"P",{"data-svelte-h":!0}),r(d)!=="svelte-nh0hdd"&&(d.innerHTML=Ue),B=p(e),k=n(e,"P",{"data-svelte-h":!0}),r(k)!=="svelte-fhbzri"&&(k.textContent=Je),Y=p(e),m=n(e,"H1",{"data-svelte-h":!0}),r(m)!=="svelte-1v0ycgb"&&(m.textContent=Ke),Z=p(e),v=n(e,"H2",{"data-svelte-h":!0}),r(v)!=="svelte-yh5mdo"&&(v.textContent=Ve),ee=p(e),w=n(e,"P",{"data-svelte-h":!0}),r(w)!=="svelte-10leyij"&&(w.innerHTML=Xe),te=p(e),b=n(e,"H2",{"data-svelte-h":!0}),r(b)!=="svelte-79900d"&&(b.textContent=Be),se=p(e),x=n(e,"P",{"data-svelte-h":!0}),r(x)!=="svelte-1iwfsk7"&&(x.innerHTML=Ye),ae=p(e),_=n(e,"PRE",{class:!0});var s=u(_);le=c(s,!1),s.forEach(t),ne=p(e),C=n(e,"P",{"data-svelte-h":!0}),r(C)!=="svelte-14d9hz8"&&(C.innerHTML=Ze),oe=p(e),g=n(e,"PRE",{class:!0});var mt=u(g);pe=c(mt,!1),mt.forEach(t),re=p(e),y=n(e,"P",{"data-svelte-h":!0}),r(y)!=="svelte-1dphpv8"&&(y.textContent=et),ie=p(e),T=n(e,"H2",{"data-svelte-h":!0}),r(T)!=="svelte-1lfmvcw"&&(T.textContent=tt),ue=p(e),P=n(e,"P",{"data-svelte-h":!0}),r(P)!=="svelte-1sqlkft"&&(P.innerHTML=st),ce=p(e),I=n(e,"PRE",{class:!0});var vt=u(I);fe=c(vt,!1),vt.forEach(t),he=p(e),H=n(e,"P",{"data-svelte-h":!0}),r(H)!=="svelte-1ilwo7r"&&(H.textContent=at),de=p(e),E=n(e,"PRE",{class:!0});var wt=u(E);ke=c(wt,!1),wt.forEach(t),me=p(e),M=n(e,"P",{"data-svelte-h":!0}),r(M)!=="svelte-csjniv"&&(M.textContent=lt),ve=p(e),L=n(e,"PRE",{class:!0});var bt=u(L);we=c(bt,!1),bt.forEach(t),be=p(e),S=n(e,"P",{"data-svelte-h":!0}),r(S)!=="svelte-1wuxk0l"&&(S.textContent=nt),xe=p(e),q=n(e,"PRE",{class:!0});var xt=u(q);_e=c(xt,!1),xt.forEach(t),Ce=p(e),G=n(e,"H2",{"data-svelte-h":!0}),r(G)!=="svelte-2jubjo"&&(G.textContent=ot),ge=p(e),W=n(e,"P",{"data-svelte-h":!0}),r(W)!=="svelte-28pzr1"&&(W.innerHTML=pt),ye=p(e),R=n(e,"P",{"data-svelte-h":!0}),r(R)!=="svelte-nc84b3"&&(R.textContent=rt),Te=p(e),z=n(e,"PRE",{class:!0});var _t=u(z);Pe=c(_t,!1),_t.forEach(t),Ie=p(e),F=n(e,"P",{"data-svelte-h":!0}),r(F)!=="svelte-1iq35tp"&&(F.textContent=it),He=p(e),A=n(e,"PRE",{class:!0});var Ct=u(A);Ee=c(Ct,!1),Ct.forEach(t),Me=p(e),j=n(e,"P",{"data-svelte-h":!0}),r(j)!=="svelte-13guv9p"&&(j.innerHTML=ut),Le=p(e),$=n(e,"P",{"data-svelte-h":!0}),r($)!=="svelte-1067ul8"&&($.textContent=ct),Se=p(e),D=n(e,"P",{"data-svelte-h":!0}),r(D)!=="svelte-uzxfkj"&&(D.innerHTML=ft),qe=p(e),O=n(e,"PRE",{class:!0});var gt=u(O);Ge=c(gt,!1),gt.forEach(t),We=p(e),N=n(e,"P",{"data-svelte-h":!0}),r(N)!=="svelte-adnykz"&&(N.textContent=ht),Re=p(e),Q=n(e,"PRE",{class:!0});var yt=u(Q);ze=c(yt,!1),yt.forEach(t),Fe=p(e),U=n(e,"P",{"data-svelte-h":!0}),r(U)!=="svelte-13ypnrx"&&(U.innerHTML=dt),Ae=p(e),J=n(e,"PRE",{class:!0});var Tt=u(J);je=c(Tt,!1),Tt.forEach(t),$e=p(e),K=n(e,"P",{"data-svelte-h":!0}),r(K)!=="svelte-adnykz"&&(K.textContent=kt),De=p(e),V=n(e,"PRE",{class:!0});var Pt=u(V);Oe=c(Pt,!1),Pt.forEach(t),this.h()},h(){le.a=null,f(_,"class","language-bash"),pe.a=null,f(g,"class","language-text"),fe.a=null,f(I,"class","language-bash"),ke.a=null,f(E,"class","language-bash"),we.a=null,f(L,"class","language-bash"),_e.a=null,f(q,"class","language-bash"),Pe.a=null,f(z,"class","language-text"),Ee.a=null,f(A,"class","language-text"),Ge.a=null,f(O,"class","language-undefined"),ze.a=null,f(Q,"class","language-undefined"),je.a=null,f(J,"class","language-undefined"),Oe.a=null,f(V,"class","language-undefined")},m(e,s){a(e,h,s),a(e,X,s),a(e,d,s),a(e,B,s),a(e,k,s),a(e,Y,s),a(e,m,s),a(e,Z,s),a(e,v,s),a(e,ee,s),a(e,w,s),a(e,te,s),a(e,b,s),a(e,se,s),a(e,x,s),a(e,ae,s),a(e,_,s),le.m(Ht,_),a(e,ne,s),a(e,C,s),a(e,oe,s),a(e,g,s),pe.m(Et,g),a(e,re,s),a(e,y,s),a(e,ie,s),a(e,T,s),a(e,ue,s),a(e,P,s),a(e,ce,s),a(e,I,s),fe.m(Mt,I),a(e,he,s),a(e,H,s),a(e,de,s),a(e,E,s),ke.m(Lt,E),a(e,me,s),a(e,M,s),a(e,ve,s),a(e,L,s),we.m(St,L),a(e,be,s),a(e,S,s),a(e,xe,s),a(e,q,s),_e.m(qt,q),a(e,Ce,s),a(e,G,s),a(e,ge,s),a(e,W,s),a(e,ye,s),a(e,R,s),a(e,Te,s),a(e,z,s),Pe.m(Gt,z),a(e,Ie,s),a(e,F,s),a(e,He,s),a(e,A,s),Ee.m(Wt,A),a(e,Me,s),a(e,j,s),a(e,Le,s),a(e,$,s),a(e,Se,s),a(e,D,s),a(e,qe,s),a(e,O,s),Ge.m(Rt,O),a(e,We,s),a(e,N,s),a(e,Re,s),a(e,Q,s),ze.m(zt,Q),a(e,Fe,s),a(e,U,s),a(e,Ae,s),a(e,J,s),je.m(Ft,J),a(e,$e,s),a(e,K,s),a(e,De,s),a(e,V,s),Oe.m(At,V)},p:Ne,i:Ne,o:Ne,d(e){e&&(t(h),t(X),t(d),t(B),t(k),t(Y),t(m),t(Z),t(v),t(ee),t(w),t(te),t(b),t(se),t(x),t(ae),t(_),t(ne),t(C),t(oe),t(g),t(re),t(y),t(ie),t(T),t(ue),t(P),t(ce),t(I),t(he),t(H),t(de),t(E),t(me),t(M),t(ve),t(L),t(be),t(S),t(xe),t(q),t(Ce),t(G),t(ge),t(W),t(ye),t(R),t(Te),t(z),t(Ie),t(F),t(He),t(A),t(Me),t(j),t(Le),t($),t(Se),t(D),t(qe),t(O),t(We),t(N),t(Re),t(Q),t(Fe),t(U),t(Ae),t(J),t($e),t(K),t(De),t(V))}}}const Ut={title:"IoTGoat Walkthrough",description:"My Walkthrough of IoTGoat.",date:"",categories:["IoTGoat","firmware","vulnerability"],published:!1};class Jt extends $t{constructor(h){super(),Dt(this,h,null,Ot,jt,{})}}export{Jt as default,Ut as metadata};
